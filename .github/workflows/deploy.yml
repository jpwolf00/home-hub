name: Deploy to Dokploy

on:
  push:
    branches: [master]

jobs:
  deploy:
    runs-on: [self-hosted, dokploy]
    steps:
      - name: Trigger Dokploy deployment
        run: |
          RESPONSE=$(curl -s -X POST "http://localhost:3000/api/application.deploy" \
            -H "Content-Type: application/json" \
            -H "x-api-key: EVAqvQjfcENShqTtXJRXOhqckKfFyOuznNUyxqjGhPpnHOYihBpRoODwONiLufhw" \
            -d '{"applicationId":"GXkG69roBjCi72a-VJLep"}')
          echo "Response: $RESPONSE"
          echo "Deploy triggered for home-hub"
